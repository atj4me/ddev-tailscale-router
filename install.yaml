name: ddev-tailscale-router

project_files:
  - tailscale-router/config/tailscale-private.json
  - tailscale-router/config/tailscale-public.json
  - docker-compose.tailscale-router.yaml
  - commands/host/tailscale

ddev_version_constraint: '>= v1.24.3'

post_install_actions:
  - |
    #ddev-description:Setup Tailscale router environment
    if ! ddev dotenv get .ddev/.env.tailscale-router TS_PRIVACY >/dev/null 2>&1; then
      ddev dotenv set .ddev/.env.tailscale-router --ts-privacy=private
    fi
  - |
    #ddev-description:Setup instructions for Tailscale router
    echo "ðŸš€ ddev-tailscale-router installed successfully!"
    echo "Next steps:"
    echo "1. Get your Tailscale auth key from https://tailscale.com/kb/1085/auth-keys"
    echo "2. Set it using: ddev dotenv set .ddev/.env.tailscale-router --ts-authkey=tskey-auth-xxxx"
    echo "3. Optional: Set privacy to public with: ddev dotenv set .ddev/.env.tailscale-router --ts-privacy=public"
    echo "4. Run: ddev restart"
    echo "For more info: https://github.com/atj4me/ddev-tailscale-router"
